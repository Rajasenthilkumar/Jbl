import{r,cn as z,co as se,cp as oe,aH as B,cq as ee,bA as V,cr as le,cs as ce,bT as de,_ as W,ct as _,cu as te,bM as ue,bP as me,cv as ge,bN as he,bO as E,bQ as be,cw as fe,am as ae,cx as ie,an as F,cy as re,cz as ve,a0 as pe,a1 as Se,j as l,cA as xe,a2 as Y,a5 as L,a7 as X,cB as ye,aN as J,x as K,B as $e,cC as Ce,cD as je,$ as we,cE as Ne,cF as Re,cG as Ie,cH as Me,cI as He,cJ as Ee,q as Pe,b4 as Oe,cK as Te}from"./index-BD9lYu5U.js";import{E as Le}from"./EmailVerify-lXjxklXI.js";import{G as _e}from"./GuestLoginIcon-BGeocUGB.js";import{M as ze}from"./MailIcon-2Ggx5cXu.js";var Q=function(t,n){if(!t)return null;var a={left:t.offsetLeft,right:t.parentElement.clientWidth-t.clientWidth-t.offsetLeft,width:t.clientWidth,top:t.offsetTop,bottom:t.parentElement.clientHeight-t.clientHeight-t.offsetTop,height:t.clientHeight};return n?{left:0,right:0,width:0,top:a.top,bottom:a.bottom,height:a.height}:{left:a.left,right:a.right,width:a.width,top:0,bottom:0,height:0}},w=function(t){return t!==void 0?"".concat(t,"px"):void 0};function Ve(e){var t=e.prefixCls,n=e.containerRef,a=e.value,s=e.getValueIndex,o=e.motionName,b=e.onMotionStart,v=e.onMotionEnd,c=e.direction,S=e.vertical,d=S===void 0?!1:S,C=r.useRef(null),g=r.useState(a),u=z(g,2),p=u[0],P=u[1],N=function(M){var f,H=s(M),j=(f=n.current)===null||f===void 0?void 0:f.querySelectorAll(".".concat(t,"-item"))[H];return j?.offsetParent&&j},O=r.useState(null),R=z(O,2),i=R[0],y=R[1],x=r.useState(null),$=z(x,2),m=$[0],I=$[1];se(function(){if(p!==a){var h=N(p),M=N(a),f=Q(h,d),H=Q(M,d);P(a),y(f),I(H),h&&M?b():v()}},[a]);var T=r.useMemo(function(){if(d){var h;return w((h=i?.top)!==null&&h!==void 0?h:0)}return w(c==="rtl"?-i?.right:i?.left)},[d,c,i]),D=r.useMemo(function(){if(d){var h;return w((h=m?.top)!==null&&h!==void 0?h:0)}return w(c==="rtl"?-m?.right:m?.left)},[d,c,m]),A=function(){return d?{transform:"translateY(var(--thumb-start-top))",height:"var(--thumb-start-height)"}:{transform:"translateX(var(--thumb-start-left))",width:"var(--thumb-start-width)"}},q=function(){return d?{transform:"translateY(var(--thumb-active-top))",height:"var(--thumb-active-height)"}:{transform:"translateX(var(--thumb-active-left))",width:"var(--thumb-active-width)"}},G=function(){y(null),I(null),v()};return!i||!m?null:r.createElement(oe,{visible:!0,motionName:o,motionAppear:!0,onAppearStart:A,onAppearActive:q,onVisibleChanged:G},function(h,M){var f=h.className,H=h.style,j=B(B({},H),{},{"--thumb-start-left":T,"--thumb-start-width":w(i?.width),"--thumb-active-left":D,"--thumb-active-width":w(m?.width),"--thumb-start-top":T,"--thumb-start-height":w(i?.height),"--thumb-active-top":D,"--thumb-active-height":w(m?.height)}),ne={ref:ee(C,M),style:j,className:V("".concat(t,"-thumb"),f)};return r.createElement("div",ne)})}var De=["prefixCls","direction","vertical","options","disabled","defaultValue","value","onChange","className","motionName"];function Ae(e){if(typeof e.title<"u")return e.title;if(te(e.label)!=="object"){var t;return(t=e.label)===null||t===void 0?void 0:t.toString()}}function Ge(e){return e.map(function(t){if(te(t)==="object"&&t!==null){var n=Ae(t);return B(B({},t),{},{title:n})}return{label:t?.toString(),title:t?.toString(),value:t}})}var Be=function(t){var n=t.prefixCls,a=t.className,s=t.disabled,o=t.checked,b=t.label,v=t.title,c=t.value,S=t.onChange,d=function(g){s||S(g,c)};return r.createElement("label",{className:V(a,_({},"".concat(n,"-item-disabled"),s))},r.createElement("input",{className:"".concat(n,"-item-input"),type:"radio",disabled:s,checked:o,onChange:d}),r.createElement("div",{className:"".concat(n,"-item-label"),title:v,role:"option","aria-selected":o},b))},Fe=r.forwardRef(function(e,t){var n,a,s=e.prefixCls,o=s===void 0?"rc-segmented":s,b=e.direction,v=e.vertical,c=e.options,S=c===void 0?[]:c,d=e.disabled,C=e.defaultValue,g=e.value,u=e.onChange,p=e.className,P=p===void 0?"":p,N=e.motionName,O=N===void 0?"thumb-motion":N,R=le(e,De),i=r.useRef(null),y=r.useMemo(function(){return ee(i,t)},[i,t]),x=r.useMemo(function(){return Ge(S)},[S]),$=ce((n=x[0])===null||n===void 0?void 0:n.value,{value:g,defaultValue:C}),m=z($,2),I=m[0],T=m[1],D=r.useState(!1),A=z(D,2),q=A[0],G=A[1],h=function(H,j){d||(T(j),u?.(j))},M=de(R,["children"]);return r.createElement("div",W({role:"listbox","aria-label":"segmented control"},M,{className:V(o,(a={},_(a,"".concat(o,"-rtl"),b==="rtl"),_(a,"".concat(o,"-disabled"),d),_(a,"".concat(o,"-vertical"),v),a),P),ref:y}),r.createElement("div",{className:"".concat(o,"-group")},r.createElement(Ve,{vertical:v,prefixCls:o,value:I,containerRef:i,motionName:"".concat(o,"-").concat(O),direction:b,getValueIndex:function(H){return x.findIndex(function(j){return j.value===H})},onMotionStart:function(){G(!0)},onMotionEnd:function(){G(!1)}}),x.map(function(f){return r.createElement(Be,W({},f,{key:f.value,prefixCls:o,className:V(f.className,"".concat(o,"-item"),_({},"".concat(o,"-item-selected"),f.value===I&&!q)),checked:f.value===I,onChange:h,disabled:!!d||!!f.disabled}))})))}),qe=Fe;function U(e,t){return{[`${e}, ${e}:hover, ${e}:focus`]:{color:t.colorTextDisabled,cursor:"not-allowed"}}}function Z(e){return{backgroundColor:e.itemSelectedBg,boxShadow:e.boxShadowTertiary}}const Xe=Object.assign({overflow:"hidden"},ge),We=e=>{const{componentCls:t}=e,n=e.calc(e.controlHeight).sub(e.calc(e.trackPadding).mul(2)).equal(),a=e.calc(e.controlHeightLG).sub(e.calc(e.trackPadding).mul(2)).equal(),s=e.calc(e.controlHeightSM).sub(e.calc(e.trackPadding).mul(2)).equal();return{[t]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},he(e)),{display:"inline-block",padding:e.trackPadding,color:e.itemColor,background:e.trackBg,borderRadius:e.borderRadius,transition:`all ${e.motionDurationMid} ${e.motionEaseInOut}`,[`${t}-group`]:{position:"relative",display:"flex",alignItems:"stretch",justifyItems:"flex-start",flexDirection:"row",width:"100%"},[`&${t}-rtl`]:{direction:"rtl"},[`&${t}-vertical`]:{[`${t}-group`]:{flexDirection:"column"},[`${t}-thumb`]:{width:"100%",height:0,padding:`0 ${E(e.paddingXXS)}`}},[`&${t}-block`]:{display:"flex"},[`&${t}-block ${t}-item`]:{flex:1,minWidth:0},[`${t}-item`]:{position:"relative",textAlign:"center",cursor:"pointer",transition:`color ${e.motionDurationMid} ${e.motionEaseInOut}`,borderRadius:e.borderRadiusSM,transform:"translateZ(0)","&-selected":Object.assign(Object.assign({},Z(e)),{color:e.itemSelectedColor}),"&::after":{content:'""',position:"absolute",zIndex:-1,width:"100%",height:"100%",top:0,insetInlineStart:0,borderRadius:"inherit",transition:`background-color ${e.motionDurationMid}`,pointerEvents:"none"},[`&:hover:not(${t}-item-selected):not(${t}-item-disabled)`]:{color:e.itemHoverColor,"&::after":{backgroundColor:e.itemHoverBg}},[`&:active:not(${t}-item-selected):not(${t}-item-disabled)`]:{color:e.itemHoverColor,"&::after":{backgroundColor:e.itemActiveBg}},"&-label":Object.assign({minHeight:n,lineHeight:E(n),padding:`0 ${E(e.segmentedPaddingHorizontal)}`},Xe),"&-icon + *":{marginInlineStart:e.calc(e.marginSM).div(2).equal()},"&-input":{position:"absolute",insetBlockStart:0,insetInlineStart:0,width:0,height:0,opacity:0,pointerEvents:"none"}},[`${t}-thumb`]:Object.assign(Object.assign({},Z(e)),{position:"absolute",insetBlockStart:0,insetInlineStart:0,width:0,height:"100%",padding:`${E(e.paddingXXS)} 0`,borderRadius:e.borderRadiusSM,transition:`transform ${e.motionDurationSlow} ${e.motionEaseInOut}, height ${e.motionDurationSlow} ${e.motionEaseInOut}`,[`& ~ ${t}-item:not(${t}-item-selected):not(${t}-item-disabled)::after`]:{backgroundColor:"transparent"}}),[`&${t}-lg`]:{borderRadius:e.borderRadiusLG,[`${t}-item-label`]:{minHeight:a,lineHeight:E(a),padding:`0 ${E(e.segmentedPaddingHorizontal)}`,fontSize:e.fontSizeLG},[`${t}-item, ${t}-thumb`]:{borderRadius:e.borderRadius}},[`&${t}-sm`]:{borderRadius:e.borderRadiusSM,[`${t}-item-label`]:{minHeight:s,lineHeight:E(s),padding:`0 ${E(e.segmentedPaddingHorizontalSM)}`},[`${t}-item, ${t}-thumb`]:{borderRadius:e.borderRadiusXS}}}),U(`&-disabled ${t}-item`,e)),U(`${t}-item-disabled`,e)),{[`${t}-thumb-motion-appear-active`]:{transition:`transform ${e.motionDurationSlow} ${e.motionEaseInOut}, width ${e.motionDurationSlow} ${e.motionEaseInOut}`,willChange:"transform, width"}})}},Ye=e=>{const{colorTextLabel:t,colorText:n,colorFillSecondary:a,colorBgElevated:s,colorFill:o,lineWidthBold:b,colorBgLayout:v}=e;return{trackPadding:b,trackBg:v,itemColor:t,itemHoverColor:n,itemHoverBg:a,itemSelectedBg:s,itemActiveBg:o,itemSelectedColor:n}},Je=ue("Segmented",e=>{const{lineWidth:t,calc:n}=e,a=me(e,{segmentedPaddingHorizontal:n(e.controlPaddingHorizontal).sub(t).equal(),segmentedPaddingHorizontalSM:n(e.controlPaddingHorizontalSM).sub(t).equal()});return[We(a)]},Ye);var k=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(n[a[s]]=e[a[s]]);return n};function Ke(e){return typeof e=="object"&&!!e?.icon}const Qe=r.forwardRef((e,t)=>{const{prefixCls:n,className:a,rootClassName:s,block:o,options:b=[],size:v="middle",style:c,vertical:S}=e,d=k(e,["prefixCls","className","rootClassName","block","options","size","style","vertical"]),{getPrefixCls:C,direction:g,segmented:u}=r.useContext(be),p=C("segmented",n),[P,N,O]=Je(p),R=fe(v),i=r.useMemo(()=>b.map($=>{if(Ke($)){const{icon:m,label:I}=$,T=k($,["icon","label"]);return Object.assign(Object.assign({},T),{label:r.createElement(r.Fragment,null,r.createElement("span",{className:`${p}-item-icon`},m),I&&r.createElement("span",null,I))})}return $}),[b,p]),y=V(a,s,u?.className,{[`${p}-block`]:o,[`${p}-sm`]:R==="small",[`${p}-lg`]:R==="large",[`${p}-vertical`]:S},N,O),x=Object.assign(Object.assign({},u?.style),c);return P(r.createElement(qe,Object.assign({},d,{className:y,style:x,options:i,ref:t,prefixCls:p,direction:g,vertical:S})))}),Ue=Qe,Ze=ae({mode:ie("Host"),email:F().min(1,{message:"Email is required"}).email({message:"Invalid email address"}),password:F().min(5,{message:"Password must be at least 5 characters"}),rememberMe:re()}),ke=ae({mode:ie("Guest"),id_number:F().min(1,{message:"Identification Number is required"}),password:F().min(5,{message:"Password must be at least 5 characters"}),rememberMe:re()}),et=ve("mode",[Ze,ke]),tt=({onFinishForm:e,isSubmitting:t,handleRememberMe:n,handleRememberGuest:a,id_number:s,email:o,rememberMe:b,rememberGuest:v,mode:c,setMode:S})=>{const{control:d,handleSubmit:C,reset:g}=pe({defaultValues:{id_number:s,email:o,password:"",rememberMe:b,rememberGuest:v,mode:c},resolver:Se(et)});return r.useEffect(()=>{g({email:c==="Host"?o:"",id_number:c==="Guest"?s:"",password:"",rememberMe:c==="Host"?b:v,mode:c})},[c,g,o,s]),l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"flex justify-start mb-4",children:l.jsx(Ue,{options:["Host","Guest"],value:c,onChange:u=>S(u),size:"large",className:"custom-segmented"})}),l.jsxs(xe,{title:`Log in to your ${c} account`,subTitle:c==="Host"?`Log in to your ${c.toLowerCase()} account by entering your registered email address and password.`:"To log in, enter your ID number and password.",children:[l.jsx(Y,{onFinish:C(e),id:"login-form",children:l.jsxs("div",{className:"flex flex-col gap-1",children:[c==="Host"?l.jsx(L,{control:d,name:"email",children:l.jsx(X,{prefix:l.jsx(ze,{}),placeholder:"Enter your email address",size:"large",variant:"filled",className:"py-3",id:"email",value:o,onChange:u=>o=u.target.value})}):l.jsx(L,{control:d,name:"id_number",children:l.jsx(X,{prefix:l.jsx(_e,{}),placeholder:"Enter your Identification Number",size:"large",variant:"filled",className:"py-3",id:"id_number",value:s,onChange:u=>s=u.target.value})}),l.jsx(L,{control:d,name:"password",children:l.jsx(X.Password,{placeholder:"Password",size:"large",variant:"filled",className:"py-3",prefix:l.jsx(ye,{}),id:"password"})}),l.jsxs("div",{className:"flex justify-between mb-6",children:[c==="Host"?l.jsx(L,{control:d,className:"mx-2",name:"rememberMe",valuePropName:"checked",children:l.jsx(J,{onChange:u=>n(u.target.checked),children:"Remember Me"})}):l.jsx(L,{control:d,className:"mx-2",name:"rememberMe",valuePropName:"checked",children:l.jsx(J,{onChange:u=>a(u.target.checked),children:"Remember Me"})}),l.jsx(K,{to:`/forgot-password?mode=${c}`,id:"forgot-password",className:"font-bold text-primary",children:"Forgot password?"})]}),l.jsx(Y.Item,{children:l.jsx($e,{type:"primary",htmlType:"submit",size:"large",className:"w-full py-6 mt-2 font-bold",loading:t,id:"login-button",children:"Log In"})})]})}),c==="Host"&&l.jsxs("p",{className:"mt-16 text-center text-PrimaryText",id:"signup-link",children:["Don't have an account?"," ",l.jsx(K,{to:"/sign-up",className:"font-bold text-primary",children:"Sign up"})]})]})]})},at=()=>{const{loading:e,error:t,success:n,handleRequest:a}=Ce(je.post);return{loading:e,error:t,success:n,login:async o=>{const b=o.mode==="Host"?"/api/host/login":"/api/guest/login";return await a(b,o)}}},it=()=>{const{loading:e,login:t}=at(),[n,a]=r.useState(!1),[s,o]=r.useState(void 0),[b,v]=r.useState(void 0),[c,S]=r.useState(!1),[d,C]=r.useState(!1),[g,u]=r.useState("Host"),p=we(),P=i=>{S(i)},N=i=>{C(i)};r.useEffect(()=>{if(g==="Host"){const i=Ne();i?.email&&(o(i.email),S(i.remember_me??!1))}else if(g==="Guest"){const i=Re();i?.id_number&&(v(i.id_number),C(i.remember_me??!1))}},[g]);const O=async i=>{try{const y={...i,mode:g},{data:x}=await t(y);Ie({token:x.result.data.token,id:x.result.data.id,mode:g}),g==="Host"&&c?Me({email:y.email,remember_me:!0}):g==="Guest"&&d&&He({id_number:y.id_number,remember_me:!0}),p(Ee({userId:x.result.data.id,token:x.result.data.token,mode:g})),Pe.success("Login successful!")}catch(y){Oe(y);const x=y;if(x.data?.error?.msg){const $=x.data.error.msg;typeof $=="string"&&$==="Email is not verified"&&(a(!0),o(i.email))}}},R=()=>{a(!1),o(void 0)};return s&&n?l.jsx(Le,{email:s,onClickGotIt:R}):l.jsx(tt,{onFinishForm:O,handleRememberMe:P,handleRememberGuest:N,isSubmitting:e,email:s,rememberMe:c,mode:g,setMode:u,id_number:b||"",rememberGuest:d},s)},lt=()=>l.jsx(Te,{children:l.jsx(it,{})});export{lt as default};
